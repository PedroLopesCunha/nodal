<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= @organisation&.name || 'Nodal' %></title>
  </head>

  <body style="margin: 0; padding: 0; background-color: #f4f4f4; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
    <!-- Email wrapper table -->
    <table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0" style="background-color: #f4f4f4;">
      <tr>
        <td align="center" style="padding: 40px 20px;">
          <!-- Main content container -->
          <table role="presentation" width="600" cellspacing="0" cellpadding="0" border="0" style="background-color: #ffffff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
            <!-- Header with logo -->
            <tr>
              <td align="center" style="padding: 32px 40px; border-bottom: 1px solid #e5e5e5;">
                <% if @organisation&.logo&.attached? %>
                  <!-- Organisation logo -->
                  <%= image_tag url_for(@organisation.logo), alt: @organisation.name, style: "max-height: 50px; max-width: 180px; object-fit: contain;" %>
                <% elsif @organisation %>
                  <!-- Organisation name as logo -->
                  <table role="presentation" cellspacing="0" cellpadding="0" border="0">
                    <tr>
                      <td style="background-color: <%= @organisation.effective_primary_color %>; border-radius: 10px; width: 40px; height: 40px; text-align: center; vertical-align: middle;">
                        <span style="font-size: 24px; font-weight: 800; color: #ffffff; line-height: 40px;"><%= @organisation.name.first.upcase %></span>
                      </td>
                      <td style="padding-left: 2px;">
                        <span style="font-size: 28px; font-weight: 700; color: #1a1a1a; letter-spacing: -0.5px;"><%= @organisation.name[1..] %></span>
                      </td>
                    </tr>
                  </table>
                <% else %>
                  <!-- Default Nodal logo -->
                  <table role="presentation" cellspacing="0" cellpadding="0" border="0">
                    <tr>
                      <td style="background-color: #008060; border-radius: 10px; width: 40px; height: 40px; text-align: center; vertical-align: middle;">
                        <span style="font-size: 24px; font-weight: 800; color: #ffffff; line-height: 40px;">N</span>
                      </td>
                      <td style="padding-left: 2px;">
                        <span style="font-size: 28px; font-weight: 700; color: #1a1a1a; letter-spacing: -0.5px;">odal</span>
                      </td>
                    </tr>
                  </table>
                <% end %>
              </td>
            </tr>

            <!-- Email body -->
            <tr>
              <td style="padding: 40px; color: #1a1a1a; font-size: 16px; line-height: 1.6;">
                <%= yield %>
              </td>
            </tr>

            <!-- Footer -->
            <tr>
              <td style="padding: 24px 40px; background-color: #f9fafb; border-top: 1px solid #e5e5e5; border-radius: 0 0 8px 8px;">
                <table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0">
                  <tr>
                    <td align="center" style="color: #6b7177; font-size: 13px; line-height: 1.5;">
                      <% if @organisation %>
                        <p style="margin: 0 0 12px 0;">&copy; <%= Date.today.year %> <%= @organisation.name %>. All rights reserved.</p>
                      <% end %>
                      <!-- Powered by Nodal -->
                      <p style="margin: 0;">
                        <span style="color: #9ca3af;">powered by </span>
                        <a href="https://www.nodal-seiri.dev" target="_blank" rel="noopener" style="text-decoration: none;">
                          <span style="display: inline-block; background-color: #008060; color: #ffffff; font-size: 10px; font-weight: 800; padding: 2px 5px; border-radius: 3px; vertical-align: middle;">N</span><span style="font-weight: 600; color: #008060;">odal</span>
                        </a>
                      </p>
                    </td>
                  </tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
  </body>
</html>
